<Window x:Class="CinemaChain.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cinema Manager - Admin Panel" Height="600" Width="1000"
        Loaded="Window_Loaded"
        Background="#FFF0F5">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#FF69B4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF1493"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#FFB6C1"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#FFB6C1"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid>
        <TabControl Margin="5" BorderBrush="#FF69B4">

            <TabItem Header="Manage Cinemas" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <DataGrid x:Name="CinemasGrid" Grid.Column="0" AutoGenerateColumns="False" 
                              SelectionChanged="CinemasGrid_SelectionChanged" IsReadOnly="True" BorderBrush="#FF69B4" BorderThickness="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding CinemaId}" Width="Auto" MinWidth="60"/>
                            <DataGridTextColumn Header="City" Binding="{Binding City}" Width="*"/>
                            <DataGridTextColumn Header="Address" Binding="{Binding Address}" Width="*"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <TextBlock Text="Cinema Details" FontWeight="Bold" FontSize="16" Foreground="#C71585" Margin="0,0,0,10"/>
                        <Label Content="City:" Foreground="#C71585"/>
                        <TextBox x:Name="CinCityTxt" BorderBrush="#FF69B4"/>
                        <Label Content="Address:" Foreground="#C71585"/>
                        <TextBox x:Name="CinAddressTxt" BorderBrush="#FF69B4"/>
                        <Label Content="Email:" Foreground="#C71585"/>
                        <TextBox x:Name="CinEmailTxt" BorderBrush="#FF69B4"/>
                        <StackPanel Orientation="Horizontal" Margin="0,20,0,0" HorizontalAlignment="Center">
                            <Button Content="Add" Click="AddCinema_Click" Margin="5" Width="60"/>
                            <Button Content="Update" Click="UpdateCinema_Click" Margin="5" Width="60"/>
                            <Button Content="Delete" Click="DeleteCinema_Click" Margin="5" Width="60"/>
                        </StackPanel>
                        <Button Content="Clear Form" Click="ClearCinema_Click" Margin="5,10,5,5" Background="#DB7093"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Manage Halls" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <Label Content="Filter by Cinema:" VerticalAlignment="Center" Foreground="#C71585" FontWeight="SemiBold"/>
                            <ComboBox x:Name="HallFilterCombo" Width="200" Margin="5,0" 
                                      DisplayMemberPath="Address" SelectedValuePath="CinemaId"
                                      SelectionChanged="HallFilterCombo_SelectionChanged" BorderBrush="#FF69B4"/>
                            <Button Content="Show All" Click="ClearHallFilter_Click" Width="80"/>
                        </StackPanel>

                        <DataGrid x:Name="HallsGrid" Grid.Row="1" AutoGenerateColumns="False" 
                                  SelectionChanged="HallsGrid_SelectionChanged" IsReadOnly="True" BorderBrush="#FF69B4" BorderThickness="1">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding HallId}" Width="Auto" MinWidth="60"/>
                                <DataGridTextColumn Header="Hall Name" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Seats" Binding="{Binding SeatsCount}" Width="60"/>
                                <DataGridTextColumn Header="Cinema" Binding="{Binding Cinema.Address}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>

                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <TextBlock Text="Hall Details" FontWeight="Bold" FontSize="16" Foreground="#C71585" Margin="0,0,0,10"/>
                        <Label Content="Hall Name:" Foreground="#C71585"/>
                        <TextBox x:Name="HallNameTxt" BorderBrush="#FF69B4"/>
                        <Label Content="Seats Count:" Foreground="#C71585"/>
                        <TextBox x:Name="HallSeatsTxt" BorderBrush="#FF69B4"/>
                        <Label Content="Belongs to Cinema:" Foreground="#C71585"/>
                        <ComboBox x:Name="CinemaComboBox" DisplayMemberPath="Address" SelectedValuePath="CinemaId" BorderBrush="#FF69B4"/>
                        <StackPanel Orientation="Horizontal" Margin="0,20,0,0" HorizontalAlignment="Center">
                            <Button Content="Add" Click="AddHall_Click" Margin="5" Width="60"/>
                            <Button Content="Update" Click="UpdateHall_Click" Margin="5" Width="60"/>
                            <Button Content="Delete" Click="DeleteHall_Click" Margin="5" Width="60"/>
                        </StackPanel>
                        <Button Content="Clear Form" Click="ClearHall_Click" Margin="5,10,5,5" Background="#DB7093"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Movies (Search)" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Search Title:" Foreground="#C71585" VerticalAlignment="Center"/>
                        <TextBox x:Name="SearchMovieTxt" Width="200" Margin="5,0" BorderBrush="#FF69B4" VerticalContentAlignment="Center"/>
                        <Button Content="Search" Click="SearchMovies_Click" Width="80"/>
                    </StackPanel>

                    <DataGrid x:Name="MoviesGrid" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" BorderBrush="#FF69B4" BorderThickness="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding MovieId}" Width="Auto" MinWidth="60"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="*"/>
                            <DataGridTextColumn Header="Duration (min)" Binding="{Binding Duration}" Width="100"/>
                            <DataGridTextColumn Header="Age" Binding="{Binding AgeRestriction}" Width="50"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                        <Button x:Name="BtnPrevPage" Content="&lt; Prev" Click="PrevPage_Click" Width="80" Margin="5"/>
                        <TextBlock x:Name="TxtPageInfo" Text="Page 1" VerticalAlignment="Center" Foreground="#C71585" FontWeight="Bold" Margin="10"/>
                        <Button x:Name="BtnNextPage" Content="Next &gt;" Click="NextPage_Click" Width="80" Margin="5"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Ticket Sales (Trans)" FontSize="14" FontWeight="Bold">
                <Grid Margin="20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Margin="10">
                        <TextBlock Text="Sell Ticket (Transaction Demo)" FontSize="18" Foreground="#C71585" FontWeight="Bold" Margin="0,0,0,20"/>

                        <Label Content="Select Session:" Foreground="#C71585" FontWeight="SemiBold"/>
                        <ComboBox x:Name="SessionCombo" DisplayMemberPath="DisplayInfo" SelectedValuePath="SessionId" Margin="0,0,0,10" BorderBrush="#FF69B4"/>

                        <Label Content="Row Number:" Foreground="#C71585" FontWeight="SemiBold"/>
                        <TextBox x:Name="TxtRow" Margin="0,0,0,10" BorderBrush="#FF69B4"/>

                        <Label Content="Seat Number:" Foreground="#C71585" FontWeight="SemiBold"/>
                        <TextBox x:Name="TxtSeat" Margin="0,0,0,20" BorderBrush="#FF69B4"/>

                        <Button Content="💰 Sell Ticket (Commit Transaction)" Click="SellTicket_Click" Height="40" FontSize="14"/>
                        <TextBlock Text="* Tries to insert ticket within a DB Transaction." Foreground="Gray" FontSize="10" Margin="0,5,0,0" TextWrapping="Wrap"/>
                    </StackPanel>

                    <TextBlock Grid.Column="1" Text="Info: If you try to sell the same seat twice, the Transaction will Rollback due to the DB Trigger/Constraint!" 
                               TextWrapping="Wrap" VerticalAlignment="Center" Margin="20" Foreground="#C71585" FontStyle="Italic"/>
                </Grid>
            </TabItem>

            <TabItem Header="Analytics (SQL)" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="🔄 Refresh Data (Native SQL)" Click="RefreshAnalytics_Click" Width="200" Height="30"/>
                        <TextBlock x:Name="TxtTotalRevenue" Text="Total Revenue: $0.00" VerticalAlignment="Center" Margin="20,0,0,0" FontSize="16" FontWeight="Bold" Foreground="Green"/>
                    </StackPanel>

                    <DataGrid x:Name="AnalyticsGrid" Grid.Row="1" AutoGenerateColumns="True" IsReadOnly="True" BorderBrush="#FF69B4" BorderThickness="1"/>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</Window>